<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>~/ILP/main.hs.html</title>
<meta name="Generator" content="Vim/7.2">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
</head>
<body bgcolor="#121212" text="#d0d0d0"><font face="monospace">
<font color="#87ff00">import</font>&nbsp;Debug.Trace<br>
<font color="#87ff00">import</font>&nbsp;Data.List<br>
<br>
<font color="#5fd7ff">type</font>&nbsp;Literal&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font>Char<font color="#ff6060">]</font><br>
<br>
<font color="#5fd7ff">type</font>&nbsp;Clause&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>Bool,&nbsp;<font color="#c00000">[</font>Char<font color="#c00000">]</font>,&nbsp;<font color="#c00000">[</font>Literal<font color="#c00000">]</font><font color="#ff6060">)</font><br>
<br>
<font color="#5fd7ff">type</font>&nbsp;Arg&nbsp;<font color="#d7005f">=</font>&nbsp;Integer<br>
<br>
<font color="#5fd7ff">type</font>&nbsp;ArgClause&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>Bool,&nbsp;<font color="#c00000">[</font>Char<font color="#c00000">]</font>,&nbsp;<font color="#c00000">[</font>Arg<font color="#c00000">]</font><font color="#ff6060">)</font><br>
<br>
<font color="#5fd7ff">type</font>&nbsp;Relation&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>ArgClause,&nbsp;<font color="#c00000">[</font>ArgClause<font color="#c00000">]</font><font color="#ff6060">)</font><br>
<br>
<font color="#5fd7ff">type</font>&nbsp;Examples&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>PosEx,&nbsp;NegEx<font color="#ff6060">)</font><br>
<br>
<font color="#5fd7ff">type</font>&nbsp;PosEx&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font>Clause<font color="#ff6060">]</font><br>
<br>
<font color="#5fd7ff">type</font>&nbsp;NegEx&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font>Clause<font color="#ff6060">]</font><br>
<br>
<font color="#5fd7ff">type</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font>Clause<font color="#ff6060">]</font><br>
<br>
<font color="#5fd7ff">type</font>&nbsp;VarMap&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>Integer,&nbsp;Literal<font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
backno&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;ann&quot;</font>,&nbsp;<font color="#afaf87">&quot;mary&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;ann&quot;</font>,&nbsp;<font color="#afaf87">&quot;tom&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;tom&quot;</font>,&nbsp;<font color="#afaf87">&quot;eve&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;tom&quot;</font>,&nbsp;<font color="#afaf87">&quot;ian&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;female&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;ann&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;female&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;mary&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;female&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;eve&quot;</font><font color="#008080">]</font><font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
backno2&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;sibling&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;james&quot;</font>,&nbsp;<font color="#afaf87">&quot;steve&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;sibling&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;steve&quot;</font>,&nbsp;<font color="#afaf87">&quot;james&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;sibling&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;greg&quot;</font>,&nbsp;<font color="#afaf87">&quot;jess&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;sibling&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;jess&quot;</font>,&nbsp;<font color="#afaf87">&quot;greg&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;sibling&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;bob&quot;</font>,&nbsp;<font color="#afaf87">&quot;mike&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;sibling&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;mike&quot;</font>,&nbsp;<font color="#afaf87">&quot;bob&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;bob&quot;</font>,&nbsp;<font color="#afaf87">&quot;james&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;bob&quot;</font>,&nbsp;<font color="#afaf87">&quot;steve&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;jane&quot;</font>,&nbsp;<font color="#afaf87">&quot;james&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;jane&quot;</font>,&nbsp;<font color="#afaf87">&quot;steve&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;mike&quot;</font>,&nbsp;<font color="#afaf87">&quot;greg&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;mike&quot;</font>,&nbsp;<font color="#afaf87">&quot;jess&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;sharon&quot;</font>,&nbsp;<font color="#afaf87">&quot;greg&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;sharon&quot;</font>,&nbsp;<font color="#afaf87">&quot;jess&quot;</font><font color="#008080">]</font><font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
backno4&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;a&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;1&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;a&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;2&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;a&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;3&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;b&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;4&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;b&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;5&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;b&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;6&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;c&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;7&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;c&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;8&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;c&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;9&quot;</font><font color="#008080">]</font><font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
pEx4&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;1&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;2&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;3&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;7&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;8&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;9&quot;</font><font color="#008080">]</font><font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
nEx4&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;4&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;5&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;6&quot;</font><font color="#008080">]</font><font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
rel0&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#af5fff">1</font><font color="#008080">]</font><font color="#c00000">)</font>,&nbsp;<font color="#c00000">[</font><font color="#008080">(</font>False,&nbsp;<font color="#afaf87">&quot;a&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">1</font><font color="#008000">]</font><font color="#008080">)</font>,&nbsp;<font color="#008080">(</font>False,&nbsp;<font color="#afaf87">&quot;c&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">1</font><font color="#008000">]</font><font color="#008080">)</font><font color="#c00000">]</font><font color="#ff6060">)</font><br>
rel01&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#af5fff">1</font><font color="#008080">]</font><font color="#c00000">)</font>,&nbsp;<font color="#c00000">[</font><font color="#008080">(</font>False,&nbsp;<font color="#afaf87">&quot;b&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">1</font><font color="#008000">]</font><font color="#008080">)</font><font color="#c00000">]</font><font color="#ff6060">)</font><br>
rel02&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;d&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#af5fff">1</font><font color="#008080">]</font><font color="#c00000">)</font>,&nbsp;<font color="#c00000">[</font><font color="#008080">(</font>True,&nbsp;<font color="#afaf87">&quot;a&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">1</font><font color="#008000">]</font><font color="#008080">)</font>,&nbsp;<font color="#008080">(</font>True,&nbsp;<font color="#afaf87">&quot;c&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">1</font><font color="#008000">]</font><font color="#008080">)</font><font color="#c00000">]</font><font color="#ff6060">)</font><br>
<br>
pEx2&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;james&quot;</font>,&nbsp;<font color="#afaf87">&quot;greg&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;greg&quot;</font>,&nbsp;<font color="#afaf87">&quot;james&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;steve&quot;</font>,&nbsp;<font color="#afaf87">&quot;greg&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;greg&quot;</font>,&nbsp;<font color="#afaf87">&quot;steve&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;jess&quot;</font>,&nbsp;<font color="#afaf87">&quot;james&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;jess&quot;</font>,&nbsp;<font color="#afaf87">&quot;steve&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;james&quot;</font>,&nbsp;<font color="#afaf87">&quot;jess&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;steve&quot;</font>,&nbsp;<font color="#afaf87">&quot;jess&quot;</font><font color="#008080">]</font><font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
nEx3&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;james&quot;</font>,&nbsp;<font color="#afaf87">&quot;james&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;sharon&quot;</font>,&nbsp;<font color="#afaf87">&quot;mike&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;coisin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;steve&quot;</font>,&nbsp;<font color="#afaf87">&quot;james&quot;</font><font color="#008080">]</font><font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
<font color="#5f5f5f">-- cousin (james, greg) &lt;- parent(bob, james), sibling(bob, mike), parent(mike,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5f5f5f">-- greg)</font><br>
<font color="#5f5f5f">--</font><br>
<font color="#5f5f5f">-- 1: james</font><br>
<font color="#5f5f5f">-- 2: greg</font><br>
<font color="#5f5f5f">-- 3: bob</font><br>
<font color="#5f5f5f">-- 4: mike</font><br>
<br>
nEx2&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;jane&quot;</font>,&nbsp;<font color="#afaf87">&quot;bob&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;greg&quot;</font>,&nbsp;<font color="#afaf87">&quot;jess&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;mike&quot;</font>,&nbsp;<font color="#afaf87">&quot;sharon&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;sharon&quot;</font>,&nbsp;<font color="#afaf87">&quot;jane&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;jane&quot;</font>,&nbsp;<font color="#afaf87">&quot;jess&quot;</font><font color="#008080">]</font><font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
pEx&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;daughter&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;mary&quot;</font>,&nbsp;<font color="#afaf87">&quot;ann&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;daughter&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;eve&quot;</font>,&nbsp;<font color="#afaf87">&quot;tom&quot;</font><font color="#008080">]</font><font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
nEx&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;daughter&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;tom&quot;</font>,&nbsp;<font color="#afaf87">&quot;ann&quot;</font><font color="#008080">]</font><font color="#c00000">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;daughter&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#afaf87">&quot;eve&quot;</font>,&nbsp;<font color="#afaf87">&quot;ann&quot;</font><font color="#008080">]</font><font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
rel&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;daughter&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#af5fff">1</font>,&nbsp;<font color="#af5fff">2</font><font color="#008080">]</font><font color="#c00000">)</font>,&nbsp;<font color="#c00000">[</font><font color="#008080">(</font>True,&nbsp;<font color="#afaf87">&quot;female&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">1</font><font color="#008000">]</font><font color="#008080">)</font>,&nbsp;<font color="#008080">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">2</font>,&nbsp;<font color="#af5fff">1</font><font color="#008000">]</font><font color="#008080">)</font><font color="#c00000">]</font><font color="#ff6060">)</font><br>
rel2&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;daugther&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#af5fff">1</font>,&nbsp;<font color="#af5fff">2</font><font color="#008080">]</font><font color="#c00000">)</font>,&nbsp;<font color="#c00000">[</font><font color="#008080">(</font>True,&nbsp;<font color="#afaf87">&quot;female&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">1</font><font color="#008000">]</font><font color="#008080">)</font><font color="#c00000">]</font><font color="#ff6060">)</font><br>
rel3&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#af5fff">1</font>,&nbsp;<font color="#af5fff">2</font><font color="#008080">]</font><font color="#c00000">)</font>,&nbsp;<font color="#c00000">[</font><font color="#008080">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">3</font>,&nbsp;<font color="#af5fff">1</font><font color="#008000">]</font><font color="#008080">)</font>,&nbsp;<font color="#008080">(</font>True,&nbsp;<font color="#afaf87">&quot;sibling&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">3</font>,<font color="#af5fff">4</font><font color="#008000">]</font><font color="#008080">)</font>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008080">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">4</font>,&nbsp;<font color="#af5fff">2</font><font color="#008000">]</font><font color="#008080">)</font><font color="#c00000">]</font><font color="#ff6060">)</font><br>
rel4&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#af5fff">1</font>,&nbsp;<font color="#af5fff">2</font><font color="#008080">]</font><font color="#c00000">)</font>,&nbsp;<font color="#c00000">[</font><font color="#008080">(</font>True,&nbsp;<font color="#afaf87">&quot;parent&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">3</font>,&nbsp;<font color="#af5fff">1</font><font color="#008000">]</font><font color="#008080">)</font><font color="#c00000">]</font><font color="#ff6060">)</font><br>
rel5&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#af5fff">1</font>,&nbsp;<font color="#af5fff">2</font><font color="#008080">]</font><font color="#c00000">)</font>,&nbsp;<font color="#c00000">[</font><font color="#008080">(</font>True,&nbsp;<font color="#afaf87">&quot;sibling&quot;</font>,&nbsp;<font color="#008000">[</font><font color="#af5fff">1</font>,&nbsp;<font color="#af5fff">2</font><font color="#008000">]</font><font color="#008080">)</font><font color="#c00000">]</font><font color="#ff6060">)</font><br>
rel6&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;cousin&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#af5fff">1</font>,<font color="#af5fff">2</font><font color="#008080">]</font><font color="#c00000">)</font>,&nbsp;<font color="#c00000">[]</font><font color="#ff6060">)</font><br>
rel7&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>True,&nbsp;<font color="#afaf87">&quot;daughter&quot;</font>,&nbsp;<font color="#008080">[</font><font color="#af5fff">1</font>,<font color="#af5fff">2</font><font color="#008080">]</font><font color="#c00000">)</font>,&nbsp;<font color="#c00000">[]</font><font color="#ff6060">)</font><br>
<br>
<font color="#5f5f5f">-- hoogle?</font><br>
fst3&nbsp;<font color="#d7005f">::</font>&nbsp;<font color="#ff6060">(</font>a,&nbsp;b,&nbsp;c<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;a<br>
fst3&nbsp;<font color="#ff6060">(</font>x,&nbsp;_,&nbsp;_<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=</font>&nbsp;x<br>
<br>
snd3&nbsp;<font color="#d7005f">::</font>&nbsp;<font color="#ff6060">(</font>a,&nbsp;b,&nbsp;c<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;b<br>
snd3&nbsp;<font color="#ff6060">(</font>_,&nbsp;x,&nbsp;_<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=</font>&nbsp;x<br>
<br>
thd3&nbsp;<font color="#d7005f">::</font>&nbsp;<font color="#ff6060">(</font>a,&nbsp;b,&nbsp;c<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;c<br>
thd3&nbsp;<font color="#ff6060">(</font>_,&nbsp;_,&nbsp;x<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=</font>&nbsp;x<br>
<br>
<font color="#5f5f5f">-- get the set of ints used on the left of the relation</font><br>
getInVars&nbsp;<font color="#d7005f">::</font>&nbsp;Relation&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>Integer<font color="#ff6060">]</font><br>
getInVars&nbsp;r&nbsp;<font color="#d7005f">=</font>&nbsp;nub&nbsp;<font color="#d7005f">$</font>&nbsp;thd3&nbsp;<font color="#d7005f">$</font>&nbsp;fst&nbsp;r<br>
<br>
<font color="#5f5f5f">-- get the set of ints used on the right of the relation</font><br>
getOutVars&nbsp;<font color="#d7005f">::</font>&nbsp;Relation&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>Integer<font color="#ff6060">]</font><br>
getOutVars&nbsp;r&nbsp;<font color="#d7005f">=</font>&nbsp;nub&nbsp;<font color="#d7005f">$</font>&nbsp;concat&nbsp;<font color="#d7005f">$</font>&nbsp;map&nbsp;thd3&nbsp;<font color="#ff6060">(</font>snd&nbsp;r<font color="#ff6060">)</font><br>
<br>
<font color="#5f5f5f">-- utility for p4, messy: needs restructure and rename</font><br>
p2&nbsp;<font color="#d7005f">::</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Integer&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;VarMap&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>VarMap<font color="#ff6060">]</font><br>
p2&nbsp;b&nbsp;i&nbsp;vm&nbsp;<font color="#d7005f">=</font>&nbsp;p3&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>i,y<font color="#c00000">)</font>&nbsp;<font color="#d7005f">|</font>&nbsp;y&nbsp;<font color="#d7005f">&lt;-</font>&nbsp;<font color="#c00000">(</font>listLits&nbsp;b<font color="#c00000">)</font><font color="#ff6060">]</font>&nbsp;vm&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#5fd7ff">where</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p3&nbsp;<font color="#d7005f">::</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>Integer,&nbsp;Literal<font color="#c00000">)</font><font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;VarMap&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>VarMap<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>VarMap<font color="#ff6060">]</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p3&nbsp;<font color="#ff6060">[]</font>&nbsp;v&nbsp;s&nbsp;<font color="#d7005f">=</font>&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p3&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>xs<font color="#ff6060">)</font>&nbsp;v&nbsp;s&nbsp;<font color="#d7005f">=</font>&nbsp;p3&nbsp;xs&nbsp;v&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>v&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#008080">[</font>x<font color="#008080">]</font><font color="#c00000">)</font><font color="#d7005f">:</font>s<font color="#ff6060">)</font><br>
<br>
<font color="#5f5f5f">-- Idea is to take a list of unbound variables in the form of integers and return</font><br>
<font color="#5f5f5f">-- all the possible mappings of these integers to literals</font><br>
<font color="#5f5f5f">-- cant believe i figured this out, needs restructure and rename</font><br>
p4&nbsp;<font color="#d7005f">::</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>Integer<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>VarMap<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>VarMap<font color="#ff6060">]</font><br>
p4&nbsp;b&nbsp;<font color="#ff6060">[]</font>&nbsp;y&nbsp;<font color="#d7005f">=</font>&nbsp;y<br>
p4&nbsp;b&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>xs<font color="#ff6060">)</font>&nbsp;y&nbsp;<font color="#d7005f">=</font>&nbsp;p4&nbsp;b&nbsp;xs&nbsp;<font color="#ff6060">(</font>foldr&nbsp;<font color="#c00000">(</font><font color="#d7005f">++</font><font color="#c00000">)</font>&nbsp;<font color="#c00000">[]</font>&nbsp;<font color="#c00000">(</font>map&nbsp;<font color="#008080">(</font>p2&nbsp;b&nbsp;x<font color="#008080">)</font>&nbsp;y<font color="#c00000">)</font><font color="#ff6060">)</font><br>
<br>
<font color="#5f5f5f">-- does this relation cover the positive examples?</font><br>
coverspos&nbsp;<font color="#d7005f">::</font>&nbsp;Relation&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>Clause<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Bool<br>
coverspos&nbsp;r&nbsp;b&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#d7005f">=</font>&nbsp;True<br>
coverspos&nbsp;r&nbsp;b&nbsp;<font color="#ff6060">(</font>c<font color="#d7005f">:</font>cs<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">|</font>&nbsp;tryVMaps&nbsp;<font color="#ff6060">(</font>possMappings&nbsp;b&nbsp;r&nbsp;c<font color="#ff6060">)</font>&nbsp;r&nbsp;b&nbsp;c&nbsp;<font color="#d7005f">==</font>&nbsp;False&nbsp;<font color="#d7005f">=</font>&nbsp;False<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#d7005f">|</font>&nbsp;otherwise&nbsp;<font color="#d7005f">=</font>&nbsp;coverspos&nbsp;r&nbsp;b&nbsp;cs<br>
<br>
<font color="#5f5f5f">-- does this relation cover no negative examples?</font><br>
coversnoneg&nbsp;<font color="#d7005f">::</font>&nbsp;Relation&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>Clause<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Bool<br>
coversnoneg&nbsp;r&nbsp;b&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#d7005f">=</font>&nbsp;True<br>
coversnoneg&nbsp;r&nbsp;b&nbsp;<font color="#ff6060">(</font>c<font color="#d7005f">:</font>cs<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">|</font>&nbsp;tryVMaps&nbsp;<font color="#ff6060">(</font>possMappings&nbsp;b&nbsp;r&nbsp;c<font color="#ff6060">)</font>&nbsp;r&nbsp;b&nbsp;c&nbsp;<font color="#d7005f">==</font>&nbsp;True&nbsp;<font color="#d7005f">=</font>&nbsp;False<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#d7005f">|</font>&nbsp;otherwise&nbsp;<font color="#d7005f">=</font>&nbsp;coversnoneg&nbsp;r&nbsp;b&nbsp;cs<br>
<br>
covers&nbsp;<font color="#d7005f">::</font>&nbsp;Relation&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Examples&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Bool<br>
covers&nbsp;r&nbsp;b&nbsp;<font color="#ff6060">(</font>p,&nbsp;n<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=</font>&nbsp;and&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>coverspos&nbsp;r&nbsp;b&nbsp;p<font color="#c00000">)</font>,&nbsp;<font color="#c00000">(</font>coversnoneg&nbsp;r&nbsp;b&nbsp;n<font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
possMappings&nbsp;<font color="#d7005f">::</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Relation&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Clause&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>VarMap<font color="#ff6060">]</font><br>
possMappings&nbsp;b&nbsp;r&nbsp;c&nbsp;<font color="#d7005f">|</font>&nbsp;diff&nbsp;<font color="#d7005f">==</font>&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#d7005f">=</font>&nbsp;vm<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#d7005f">|</font>&nbsp;otherwise&nbsp;<font color="#d7005f">=</font>&nbsp;p4&nbsp;b&nbsp;diff&nbsp;vm<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#5fd7ff">where</font>&nbsp;diff&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>getOutVars&nbsp;r<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">\\</font>&nbsp;<font color="#ff6060">(</font>getInVars&nbsp;r<font color="#ff6060">)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vm&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font>zip&nbsp;<font color="#c00000">(</font>getInVars&nbsp;r<font color="#c00000">)</font>&nbsp;<font color="#c00000">(</font>thd3&nbsp;c<font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
<font color="#5f5f5f">-- do any of these vmappings work?</font><br>
tryVMaps&nbsp;<font color="#d7005f">::</font>&nbsp;<font color="#ff6060">[</font>VarMap<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Relation&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Clause&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Bool<br>
tryVMaps&nbsp;<font color="#ff6060">[]</font>&nbsp;r&nbsp;b&nbsp;c&nbsp;<font color="#d7005f">=</font>&nbsp;False<br>
tryVMaps&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>xs<font color="#ff6060">)</font>&nbsp;r&nbsp;b&nbsp;c&nbsp;<font color="#d7005f">|</font>&nbsp;tryVMap&nbsp;x&nbsp;r&nbsp;b&nbsp;c&nbsp;<font color="#d7005f">==</font>&nbsp;True&nbsp;<font color="#d7005f">=</font>&nbsp;True<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d7005f">|</font>&nbsp;otherwise&nbsp;<font color="#d7005f">=</font>&nbsp;tryVMaps&nbsp;xs&nbsp;r&nbsp;b&nbsp;c<br>
<br>
<font color="#5f5f5f">-- does this mapping fit?</font><br>
tryVMap&nbsp;<font color="#d7005f">::</font>&nbsp;VarMap&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Relation&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Clause&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Bool<br>
tryVMap&nbsp;v&nbsp;r&nbsp;b&nbsp;c&nbsp;<font color="#d7005f">=</font>&nbsp;allIn&nbsp;b&nbsp;<font color="#ff6060">(</font>arg2cla&nbsp;v&nbsp;r&nbsp;c<font color="#ff6060">)</font><br>
<br>
<font color="#5f5f5f">-- Transforms a 'conjunction' of arg clauses to real clauses</font><br>
arg2cla&nbsp;<font color="#d7005f">::</font>&nbsp;VarMap&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Relation&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Clause&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>Clause<font color="#ff6060">]</font><br>
arg2cla&nbsp;v&nbsp;r&nbsp;c&nbsp;<font color="#d7005f">=</font>&nbsp;arg2cla_&nbsp;<font color="#ff6060">(</font>snd&nbsp;r<font color="#ff6060">)</font>&nbsp;c&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#5fd7ff">where</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg2cla_&nbsp;<font color="#ff6060">[]</font>&nbsp;c&nbsp;s&nbsp;<font color="#d7005f">=</font>&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg2cla_&nbsp;<font color="#ff6060">(</font>r2<font color="#d7005f">:</font>rs<font color="#ff6060">)</font>&nbsp;c&nbsp;s&nbsp;<font color="#d7005f">=</font>&nbsp;arg2cla_&nbsp;rs&nbsp;c&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>useVMap&nbsp;v&nbsp;r2<font color="#c00000">)</font><font color="#d7005f">:</font>s<font color="#ff6060">)</font><br>
<br>
<font color="#5f5f5f">-- Utility function for arg2cla</font><br>
useVMap&nbsp;<font color="#d7005f">::</font>&nbsp;VarMap&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;ArgClause&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Clause<br>
useVMap&nbsp;v&nbsp;a&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>fst3&nbsp;a<font color="#c00000">)</font>,&nbsp;<font color="#c00000">(</font>snd3&nbsp;a<font color="#c00000">)</font>,&nbsp;<font color="#c00000">(</font>useVMap2&nbsp;v&nbsp;<font color="#008080">(</font>thd3&nbsp;a<font color="#008080">)</font><font color="#c00000">)</font><font color="#ff6060">)</font><br>
<br>
<font color="#5f5f5f">-- Utility function for arg2cla</font><br>
useVMap2&nbsp;<font color="#d7005f">::</font>&nbsp;VarMap&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>Integer<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>Literal<font color="#ff6060">]</font><br>
useVMap2&nbsp;v&nbsp;i&nbsp;<font color="#d7005f">=</font>&nbsp;useVMap_&nbsp;v&nbsp;i&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#5fd7ff">where</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;useVMap_&nbsp;v&nbsp;<font color="#ff6060">[]</font>&nbsp;s&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>reverse&nbsp;s<font color="#ff6060">)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;useVMap_&nbsp;v&nbsp;<font color="#ff6060">(</font>i<font color="#d7005f">:</font>ix<font color="#ff6060">)</font>&nbsp;s&nbsp;<font color="#d7005f">=</font>&nbsp;useVMap_&nbsp;v&nbsp;ix&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>getLit&nbsp;v&nbsp;i<font color="#c00000">)</font><font color="#d7005f">:</font>s<font color="#ff6060">)</font><br>
<br>
<br>
<font color="#5f5f5f">-- hoogle this</font><br>
<font color="#5f5f5f">-- allIn x y returns True if y is a subset of x</font><br>
allIn&nbsp;<font color="#d7005f">::</font>&nbsp;<font color="#ff6060">(</font>Eq&nbsp;a<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=&gt;</font>&nbsp;<font color="#ff6060">[</font>a<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>a<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Bool<br>
allIn&nbsp;b&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#d7005f">=</font>&nbsp;True<br>
allIn&nbsp;b&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>xs<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">|</font>&nbsp;x&nbsp;<font color="#d7005f">`elem`</font>&nbsp;b&nbsp;<font color="#d7005f">=</font>&nbsp;allIn&nbsp;b&nbsp;xs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#d7005f">|</font>&nbsp;otherwise&nbsp;<font color="#d7005f">=</font>&nbsp;False<br>
<br>
<font color="#5f5f5f">-- Finds the literal for a given index in a varmap</font><br>
getLit&nbsp;<font color="#d7005f">::</font>&nbsp;VarMap&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Integer&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Literal<br>
getLit&nbsp;<font color="#ff6060">[]</font>&nbsp;i&nbsp;<font color="#d7005f">|</font>&nbsp;trace&nbsp;<font color="#ff6060">(</font><font color="#afaf87">&quot;getLit &quot;</font>&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#c00000">(</font>show&nbsp;i<font color="#c00000">)</font><font color="#ff6060">)</font>&nbsp;False&nbsp;<font color="#d7005f">=</font>&nbsp;undefined<br>
getLit&nbsp;<font color="#ff6060">(</font>v<font color="#d7005f">:</font>vs<font color="#ff6060">)</font>&nbsp;i&nbsp;<font color="#d7005f">|</font>&nbsp;<font color="#ff6060">(</font>fst&nbsp;v<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">==</font>&nbsp;i&nbsp;<font color="#d7005f">=</font>&nbsp;snd&nbsp;v<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d7005f">|</font>&nbsp;otherwise&nbsp;<font color="#d7005f">=</font>&nbsp;getLit&nbsp;vs&nbsp;i<br>
<br>
<font color="#5f5f5f">-- Returns the list of literals used in the background knowledge</font><br>
listLits&nbsp;<font color="#d7005f">::</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>Literal<font color="#ff6060">]</font><br>
listLits&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[]</font><br>
listLits&nbsp;b&nbsp;<font color="#d7005f">=</font>&nbsp;listLits2&nbsp;b&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#5fd7ff">where</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listLits2&nbsp;<font color="#ff6060">[]</font>&nbsp;s&nbsp;<font color="#d7005f">=</font>&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listLits2&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>xs<font color="#ff6060">)</font>&nbsp;s&nbsp;<font color="#d7005f">=</font>&nbsp;listLits2&nbsp;xs&nbsp;<font color="#ff6060">(</font>addSet&nbsp;<font color="#c00000">(</font>thd3&nbsp;x<font color="#c00000">)</font>&nbsp;s<font color="#ff6060">)</font><br>
<br>
<font color="#5f5f5f">-- hoogle this</font><br>
<font color="#5f5f5f">-- Utility function for listLits</font><br>
addSet&nbsp;<font color="#d7005f">::</font>&nbsp;<font color="#ff6060">(</font>Eq&nbsp;a<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=&gt;</font>&nbsp;<font color="#ff6060">[</font>a<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>a<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>a<font color="#ff6060">]</font><br>
addSet&nbsp;<font color="#ff6060">[]</font>&nbsp;y&nbsp;<font color="#d7005f">=</font>&nbsp;y<br>
addSet&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>xs<font color="#ff6060">)</font>&nbsp;y&nbsp;<font color="#d7005f">|</font>&nbsp;x&nbsp;<font color="#d7005f">`elem`</font>&nbsp;y&nbsp;<font color="#d7005f">=</font>&nbsp;addSet&nbsp;xs&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d7005f">|</font>&nbsp;otherwise&nbsp;<font color="#d7005f">=</font>&nbsp;addSet&nbsp;xs&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>y<font color="#ff6060">)</font><br>
<br>
backInfo&nbsp;<font color="#d7005f">::</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font><font color="#008080">[</font>Char<font color="#008080">]</font>,&nbsp;Integer<font color="#c00000">)</font><font color="#ff6060">]</font><br>
backInfo&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[]</font><br>
backInfo&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>xs<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">(</font>snd3&nbsp;x<font color="#c00000">)</font>,&nbsp;<font color="#c00000">(</font>fromIntegral&nbsp;<font color="#008080">(</font>length&nbsp;<font color="#008000">(</font>thd3&nbsp;x<font color="#008000">)</font><font color="#008080">)</font><font color="#c00000">)</font><font color="#ff6060">)</font><font color="#d7005f">:</font><font color="#ff6060">(</font>backInfo&nbsp;<font color="#c00000">(</font>dropWhile&nbsp;<font color="#008080">(</font><font color="#d7005f">\</font>a&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;snd3&nbsp;a&nbsp;<font color="#d7005f">==</font>&nbsp;snd3&nbsp;x<font color="#008080">)</font>&nbsp;xs<font color="#c00000">)</font><font color="#ff6060">)</font><br>
<br>
allpos&nbsp;<font color="#d7005f">::</font>&nbsp;Integer&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">[</font>Literal<font color="#c00000">]</font><font color="#ff6060">]</font><br>
allpos&nbsp;<font color="#af5fff">1</font>&nbsp;b&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">[</font>x<font color="#c00000">]</font>&nbsp;<font color="#d7005f">|</font>&nbsp;x&nbsp;<font color="#d7005f">&lt;-</font>&nbsp;listLits&nbsp;b<font color="#ff6060">]</font><br>
allpos&nbsp;n&nbsp;b&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font>x&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#c00000">[</font>y<font color="#c00000">]</font>&nbsp;<font color="#d7005f">|</font>&nbsp;x&nbsp;<font color="#d7005f">&lt;-</font>&nbsp;<font color="#c00000">(</font>allpos&nbsp;<font color="#008080">(</font>n<font color="#d7005f">-</font><font color="#af5fff">1</font><font color="#008080">)</font>&nbsp;b<font color="#c00000">)</font>,&nbsp;y&nbsp;<font color="#d7005f">&lt;-</font>&nbsp;<font color="#c00000">(</font>listLits&nbsp;b<font color="#c00000">)</font><font color="#ff6060">]</font><br>
<br>
allpos2&nbsp;<font color="#d7005f">::</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;BackKnow<br>
allpos2&nbsp;b&nbsp;<font color="#d7005f">=</font>&nbsp;ap2&nbsp;<font color="#ff6060">(</font>backInfo&nbsp;b<font color="#ff6060">)</font>&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#5fd7ff">where</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ap2&nbsp;<font color="#ff6060">[]</font>&nbsp;x&nbsp;<font color="#d7005f">=</font>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ap2&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>xs<font color="#ff6060">)</font>&nbsp;y&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>True,&nbsp;<font color="#008080">(</font>fst&nbsp;x<font color="#008080">)</font>,&nbsp;p<font color="#c00000">)</font>&nbsp;<font color="#d7005f">|</font>&nbsp;p&nbsp;<font color="#d7005f">&lt;-</font>&nbsp;<font color="#c00000">(</font>allpos&nbsp;<font color="#008080">(</font>snd&nbsp;x<font color="#008080">)</font>&nbsp;b<font color="#c00000">)</font><font color="#ff6060">]</font>&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#ff6060">(</font>ap2&nbsp;xs&nbsp;y<font color="#ff6060">)</font><br>
<br>
showb&nbsp;<font color="#d7005f">::</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>Char<font color="#ff6060">]</font><br>
showb&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[]</font><br>
showb&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>xs<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>show&nbsp;<font color="#c00000">(</font>fst3&nbsp;x<font color="#c00000">)</font><font color="#ff6060">)</font>&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#afaf87">&quot; &quot;</font>&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#ff6060">(</font>snd3&nbsp;x<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#ff6060">(</font>show&nbsp;<font color="#c00000">(</font>thd3&nbsp;x<font color="#c00000">)</font><font color="#ff6060">)</font>&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#afaf87">&quot;</font><font color="#d7005f"><b>\n</b></font><font color="#afaf87">&quot;</font>&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#ff6060">(</font>showb&nbsp;xs<font color="#ff6060">)</font><br>
<br>
switchc&nbsp;<font color="#d7005f">::</font>&nbsp;Clause&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Clause<br>
switchc&nbsp;<font color="#ff6060">(</font>True,&nbsp;c,&nbsp;l<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>False,&nbsp;c,&nbsp;l<font color="#ff6060">)</font><br>
switchc&nbsp;<font color="#ff6060">(</font>False,&nbsp;c,&nbsp;l<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>True,&nbsp;c,&nbsp;l<font color="#ff6060">)</font><br>
<br>
switchallc&nbsp;<font color="#d7005f">::</font>&nbsp;<font color="#ff6060">[</font>Clause<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>Clause<font color="#ff6060">]</font><br>
switchallc&nbsp;<font color="#ff6060">[]</font>&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[]</font><br>
switchallc&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>xs<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>switchc&nbsp;x<font color="#ff6060">)</font><font color="#d7005f">:</font><font color="#ff6060">(</font>switchallc&nbsp;xs<font color="#ff6060">)</font><br>
<br>
completeb&nbsp;<font color="#d7005f">::</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;BackKnow<br>
completeb&nbsp;b&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>switchallc&nbsp;<font color="#c00000">(</font><font color="#008080">(</font>allpos2&nbsp;b<font color="#008080">)</font>&nbsp;<font color="#d7005f">\\</font>&nbsp;b<font color="#c00000">)</font><font color="#ff6060">)</font>&nbsp;<font color="#d7005f">++</font>&nbsp;b<br>
<br>
<font color="#5f5f5f">-- need to generate every useful argclause</font><br>
useargs&nbsp;<font color="#d7005f">::</font>&nbsp;Relation&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;BackKnow&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>ArgClause<font color="#ff6060">]</font><br>
useargs&nbsp;r&nbsp;b&nbsp;<font color="#d7005f">=</font>&nbsp;mkargcls&nbsp;<font color="#ff6060">(</font>backInfo&nbsp;b<font color="#ff6060">)</font>&nbsp;<font color="#ff6060">(</font>fromIntegral&nbsp;<font color="#c00000">(</font>length&nbsp;<font color="#008080">(</font>nub&nbsp;<font color="#008000">(</font><font color="#0000c0">(</font>getOutVars&nbsp;r<font color="#0000c0">)</font>&nbsp;<font color="#d7005f">++</font>&nbsp;getInVars&nbsp;r<font color="#008000">)</font><font color="#008080">)</font><font color="#c00000">)</font>&nbsp;&nbsp;<font color="#d7005f">+</font>&nbsp;<font color="#af5fff">1</font><font color="#ff6060">)</font><br>
<br>
numProd&nbsp;<font color="#d7005f">::</font>&nbsp;Integer&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Integer&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">[</font>Integer<font color="#c00000">]</font><font color="#ff6060">]</font><br>
numProd&nbsp;i&nbsp;<font color="#af5fff">1</font>&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">[</font>x<font color="#c00000">]</font>&nbsp;<font color="#d7005f">|</font>&nbsp;x&nbsp;<font color="#d7005f">&lt;-</font>&nbsp;<font color="#c00000">[</font><font color="#af5fff">1</font><font color="#d7005f">..</font>i<font color="#c00000">]</font><font color="#ff6060">]</font><br>
numProd&nbsp;i&nbsp;n&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font>x&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#c00000">[</font>y<font color="#c00000">]</font>&nbsp;<font color="#d7005f">|</font>&nbsp;x&nbsp;<font color="#d7005f">&lt;-</font>&nbsp;<font color="#c00000">(</font>numProd&nbsp;i&nbsp;<font color="#008080">(</font>n<font color="#d7005f">-</font><font color="#af5fff">1</font><font color="#008080">)</font><font color="#c00000">)</font>,&nbsp;y&nbsp;<font color="#d7005f">&lt;-</font>&nbsp;<font color="#c00000">[</font><font color="#af5fff">1</font><font color="#d7005f">..</font>i<font color="#c00000">]</font><font color="#ff6060">]</font><br>
<br>
mkargcls&nbsp;<font color="#d7005f">::</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font><font color="#008080">[</font>Char<font color="#008080">]</font>,&nbsp;Integer<font color="#c00000">)</font><font color="#ff6060">]</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Integer&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>ArgClause<font color="#ff6060">]</font><br>
mkargcls&nbsp;<font color="#ff6060">[]</font>&nbsp;i&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[]</font><br>
mkargcls&nbsp;<font color="#ff6060">(</font>x<font color="#d7005f">:</font>xs<font color="#ff6060">)</font>&nbsp;i&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>mkargcl&nbsp;x&nbsp;i<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#ff6060">(</font>mkargcls&nbsp;xs&nbsp;i<font color="#ff6060">)</font><br>
<br>
mkargcl&nbsp;<font color="#d7005f">::</font>&nbsp;<font color="#ff6060">(</font><font color="#c00000">[</font>Char<font color="#c00000">]</font>,&nbsp;Integer<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;Integer&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">[</font>ArgClause<font color="#ff6060">]</font><br>
mkargcl&nbsp;<font color="#ff6060">(</font>c,&nbsp;i<font color="#ff6060">)</font>&nbsp;j&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>combt&nbsp;True&nbsp;x<font color="#c00000">)</font>&nbsp;<font color="#d7005f">|</font>&nbsp;x&nbsp;<font color="#d7005f">&lt;-</font>&nbsp;endl<font color="#ff6060">]</font>&nbsp;<font color="#d7005f">++</font>&nbsp;<font color="#ff6060">[</font><font color="#c00000">(</font>combt&nbsp;False&nbsp;x<font color="#c00000">)</font>&nbsp;<font color="#d7005f">|</font>&nbsp;x&nbsp;<font color="#d7005f">&lt;-</font>&nbsp;endl<font color="#ff6060">]</font>&nbsp;<font color="#5fd7ff">where</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endl&nbsp;<font color="#d7005f">=</font>&nbsp;zip&nbsp;<font color="#ff6060">(</font>replicate&nbsp;<font color="#c00000">(</font>length&nbsp;<font color="#008080">(</font>numProd&nbsp;j&nbsp;i<font color="#008080">)</font><font color="#c00000">)</font>&nbsp;c<font color="#ff6060">)</font>&nbsp;<font color="#ff6060">(</font>numProd&nbsp;j&nbsp;i<font color="#ff6060">)</font><br>
<br>
combt&nbsp;<font color="#d7005f">::</font>&nbsp;a&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">(</font>b,&nbsp;c<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">-&gt;</font>&nbsp;<font color="#ff6060">(</font>a,&nbsp;b,&nbsp;c<font color="#ff6060">)</font><br>
combt&nbsp;x&nbsp;<font color="#ff6060">(</font>y,&nbsp;z<font color="#ff6060">)</font>&nbsp;<font color="#d7005f">=</font>&nbsp;<font color="#ff6060">(</font>x,&nbsp;y,&nbsp;z<font color="#ff6060">)</font><br>
</font></body>
</html>
